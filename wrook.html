<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5196 2007-06-03 20:25:28Z wiemann $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<p>#!python
# coding: utf-8
'''
YEah!
'''
import os
os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'
import sys, cgi, datetime, logging, urllib, hashlib, types</p>
<p>import diff, markdown2
from string import Template
from google.appengine.api import urlfetch, users, mail, images, memcache
from google.appengine.ext import db
from google.appengine.ext.db import djangoforms</p>
<p>from django.utils import translation
from django.utils.translation import gettext
from django.conf import settings
from django.db import models
from django import newforms as forms</p>
<p>from feathers import webapp, stories, utils, customize, membership, labs, proforma, talk</p>
<p>import licensing</p>
<p>#-------------------- i18n FIX start --------------------
settings._target = None
#-------------------- i18n FIX end --------------------</p>
<dl class="docutils">
<dt>class WrookRequestHandler(webapp.RequestHandler):</dt>
<dd>pass</dd>
<dt>def onRequest(self):</dt>
<dd><p class="first">self.Model = {}
self.MasterTemplate = os.path.join(os.path.dirname(__file__), &quot;views/template-main-d.html&quot;) # Sets the default template to be used by hosted modules
self.CurrentMember = membership.loginFromCookies(self) # Load the current member from the google authentication and add it to the requesthandler
self.CurrentTheme = getDefaultTheme() # Set the default theme as the current theme
self.AppConfig = getWrookAppConfig() # Load the application config from the database
if self.CurrentMember: translation.activate(self.CurrentMember.PreferedLanguage) # If the is a current member, his prefered language is activated
else: translation.activate(&quot;en&quot;) # If not, the default language is set to english
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 43)</p>
Unexpected indentation.</div>
<blockquote class="last">
'now': datetime.datetime.now(), # Add the current time tot the model
'currentMember': self.CurrentMember, # Add the current user to the model
'currentTheme': self.CurrentTheme, # Add the default theme to the model
'appConfig': self.AppConfig # Add the app config to the model
})</blockquote>
</dd>
</dl>
<p># Moments define periodes of the year where specific customization of the site occurs
# These moments can change de default, the palette, special mssages to the user
class Moment(db.Model):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 52)</p>
Unexpected indentation.</div>
<blockquote>
Title = db.StringProperty()
Begins = db.DateTimeProperty()
Ends = db.DateTimeProperty()
Created = db.DateTimeProperty(auto_now_add=True)
Theme = db.ReferenceProperty(customize.Theme, collection_name=_(&quot;Moments&quot;))
isDefault = db.BooleanProperty(default=False)
Priority = db.IntegerProperty(required=True, default=0)</blockquote>
<dl class="docutils">
<dt>class Cover(db.Model):</dt>
<dd><p class="first">SampleTitle = db.StringProperty()
TitleColor = db.StringProperty()
ThumbnailImage = db.BlobProperty(verbose_name=_(&quot;Image&quot;))
Created = db.DateTimeProperty(auto_now_add=True)
CreatedBy = db.ReferenceProperty(membership.Member, collection_name=&quot;Covers&quot;, verbose_name=_(&quot;Created by&quot;))
isReusable = db.BooleanProperty(default=False, verbose_name=_(&quot;Is this cover reusable for other books?&quot;))
isSharedWithEveryone = db.BooleanProperty(default=False, verbose_name=_(&quot;Share with everyone&quot;))</p>
<dl class="last docutils">
<dt>def thumbURL(self):</dt>
<dd><dl class="first last docutils">
<dt>if self.is_saved():</dt>
<dd>return &quot;/Covers/Thumbnail/%s?width=120&quot; % self.key()</dd>
</dl>
</dd>
<dt>def thumbURL45(self):</dt>
<dd><dl class="first last docutils">
<dt>if self.is_saved():</dt>
<dd>return &quot;/Covers/Thumbnail/%s?width=45&quot; % self.key()</dd>
</dl>
</dd>
<dt>def imageURL(self):</dt>
<dd><dl class="first last docutils">
<dt>if self.is_saved():</dt>
<dd>return &quot;<a class="reference external" href="http://www.wrook.org/Covers/Image/%s">http://www.wrook.org/Covers/Image/%s</a>&quot; % self.key()</dd>
</dl>
</dd>
</dl>
</dd>
<dt>class Book(db.Model):</dt>
<dd><p class="first">Title = db.StringProperty(default=_(&quot;New book...&quot;), required=True, verbose_name=_(&quot;Title&quot;))
Author = db.ReferenceProperty(membership.Member, collection_name=&quot;Books&quot;, verbose_name=_(&quot;Author&quot;))
Slug = db.StringProperty(verbose_name=_(&quot;Slug&quot;))
Stage = db.StringProperty(required=True, default=&quot;planning&quot;, verbose_name=_(&quot;Stage&quot;), choices=set([&quot;planning&quot;, &quot;drafting&quot;, &quot;writing&quot;, &quot;proofing&quot;, &quot;final&quot;]))
Cover = db.ReferenceProperty(Cover, collection_name=&quot;Books&quot;, verbose_name=_(&quot;Cover&quot;))
Synopsis = db.TextProperty(verbose_name=_(&quot;Synopsis&quot;))
NoteFromAuthor = db.TextProperty(verbose_name=_(&quot;Note from the author&quot;))
License = db.ReferenceProperty(licensing.LicenseType, collection_name=&quot;Books&quot;, verbose_name=_(&quot;License&quot;))
AttribDetailed = db.TextProperty(verbose_name=_(&quot;Attribution&quot;))
AttribAuthorIsAuthor = db.BooleanProperty(default=True, verbose_name=_(&quot;Are you the author&quot;))
AttribAuthorName = db.StringProperty(verbose_name=_(&quot;Author's name&quot;))</p>
<dl class="docutils">
<dt>def clearCache(self):</dt>
<dd>memcache.delete(&quot;wordcount-%s&quot; % self.key) # Removes the wordCount cache</dd>
</dl>
<p># Does a word count of all chapters, any chapter missings its word count will do it on the fly
# Cache results for an undeterminate time
def wordCount(self):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 101)</p>
Unexpected indentation.</div>
<blockquote>
<p>wordCountKey = &quot;wordcount-%s&quot; % self.key
wordCount = memcache.get(wordCountKey)
if not wordCount:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 104)</p>
Unexpected indentation.</div>
<blockquote>
<p>wordCount = 0
for chapter in self.Chapters:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 106)</p>
Unexpected indentation.</div>
<blockquote>
wordCount += chapter.getLatestRevision().calculateWordCount()</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 107)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>memcache.add(wordCountKey, wordCount)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 108)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>return wordCount</p>
</blockquote>
<dl class="last docutils">
<dt>def authorName(self):</dt>
<dd>if self.AttribAuthorIsAuthor: return self.Author.fullname()
elif self.AttribAuthorName: return self.AttribAuthorName
else: return _(&quot;Mr. Unknown&quot;)</dd>
<dt>def getCover(self):</dt>
<dd><p class="first">if self.Cover: return self.Cover
else:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 118)</p>
Unexpected indentation.</div>
<blockquote>
appConfig = getWrookAppConfig()
if appConfig: return appConfig.DefaultCover</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 120)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">return None</p>
</dd>
<dt>def firstChapter(self):</dt>
<dd><p class="first">chapter = Chapter.all().filter(&quot;Book =&quot;, self).fetch(limit=1)
if len(chapter) &gt; 0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 125)</p>
Unexpected indentation.</div>
<blockquote class="last">
return chapter[0]</blockquote>
</dd>
<dt>def lastRevisedChapter(self):</dt>
<dd><p class="first">revision = Revision.all().filter(&quot;Book =&quot;, self).order(&quot;-Created&quot;).fetch(limit=1)
if len(revision) &gt; 0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 130)</p>
Unexpected indentation.</div>
<blockquote class="last">
return revision[0].Chapter</blockquote>
</dd>
<dt>def countReaders(self):</dt>
<dd>return len(Bookmark().all().filter(&quot;Book =&quot;, self).fetch(limit=999))</dd>
<dt>def markdownAttribDetailed(self):</dt>
<dd>return markdown2.markdown(self.AttribDetailed)</dd>
</dl>
</dd>
<dt>class BookForm(djangoforms.ModelForm):</dt>
<dd><dl class="first last docutils">
<dt>class Meta:</dt>
<dd>model = Book
fields = ('Title', 'Stage', &quot;Slug&quot;, 'Synopsis', 'NoteFromAuthor')</dd>
</dl>
</dd>
<dt>class BookLicenseForm(djangoforms.ModelForm):</dt>
<dd><dl class="first last docutils">
<dt>class Meta:</dt>
<dd>model = Book
fields = ('License', 'AttribDetailed', 'AttribAuthorIsAuthor', 'AttribAuthorName')</dd>
</dl>
</dd>
<dt>class Chapter(db.Model):</dt>
<dd><p class="first">Book = db.ReferenceProperty(Book, collection_name=&quot;Chapters&quot;)
Number = db.IntegerProperty(default=0)
Name = db.StringProperty(default=_(&quot;Chapter X&quot;), required=True)
Title = db.StringProperty(default=&quot;&quot;)
Stage = db.StringProperty(required=True, default=&quot;planning&quot;, choices=set([&quot;planning&quot;, &quot;drafting&quot;, &quot;writing&quot;, &quot;proofing&quot;, &quot;final&quot;]))
Synopsis = db.TextProperty()
Created = db.DateTimeProperty(auto_now_add=True)
isDeleted = db.BooleanProperty(default = False) # An author can mark a chapter as being deleted without loosing the revision history</p>
<dl class="last docutils">
<dt>def addRevision(self, text):</dt>
<dd><p class="first">LatestRevisionVersion = 0
latestRevision = self.getLatestRevision()
if latestRevision:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 162)</p>
Unexpected indentation.</div>
<blockquote>
LatestRevisionVersion = latestRevision.Version</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 163)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>revision = Revision(</dt>
<dd>Book = self.Book,
Chapter = self,
Version = LatestRevisionVersion + 1,
Text = text
)</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 169)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">revision.put()
self.put()</p>
</dd>
<dt>def getLatestRevision(self):</dt>
<dd><p class="first">latest = self.Revisions.order(&quot;-Created&quot;).fetch(limit=1)
if len(latest) == 0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 175)</p>
Unexpected indentation.</div>
<blockquote>
return None</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 176)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>return latest[0]</dd>
</dl>
</dd>
<dt>def getLatestPublishedRevision(self):</dt>
<dd><p class="first">latest = self.Revisions.filter(&quot;isPublished&quot;, True).order(&quot;-Created&quot;).fetch(limit=1)
if len(latest) == 0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 182)</p>
Unexpected indentation.</div>
<blockquote>
return None</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 183)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>return latest[0]</dd>
</dl>
</dd>
<dt>def setBookmark(self, member):</dt>
<dd><p class="first">chapter = self
bookmarks = Bookmark.all().filter(&quot;Reader =&quot;, member).filter(&quot;Book =&quot;, chapter.Book).fetch(limit=999)
# If this is a first read, a story is posted
if len(bookmarks) == 0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 191)</p>
Unexpected indentation.</div>
<blockquote>
<p>story = StoryMemberStartReadingBook()
occurence = story.createOccurence({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 193)</p>
Unexpected indentation.</div>
<blockquote>
&quot;member&quot;: member,
&quot;book&quot;: self.Book
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 196)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>occurence.publish()</p>
</blockquote>
<p>db.delete(bookmarks)
bookmark = Bookmark(</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 200)</p>
Unexpected indentation.</div>
<blockquote>
Chapter = chapter,
Book = chapter.Book,
Author = chapter.Book.Author,
Reader = member</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 204)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">)
bookmark.put()
member.isReader = True
member.put()
return chapter</p>
</dd>
<dt>def nextChapter(self):</dt>
<dd><p class="first">#chapters = self.Book.Chapters()
chapters = Chapter.all().filter(&quot;Book =&quot;, self.Book).fetch(limit=999)
i = 0
for chapter in chapters:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 215)</p>
Unexpected indentation.</div>
<blockquote class="last">
<dl class="docutils">
<dt>if chapter.key() == self.key():</dt>
<dd><dl class="first last docutils">
<dt>if i+1 &lt; len(chapters):</dt>
<dd>return chapters[i+1]</dd>
</dl>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 218)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>i=i+1</p>
</blockquote>
</dd>
<dt>def previousChapter(self):</dt>
<dd><p class="first">#chapters = self.Book.Chapters()
chapters = Chapter.all().filter(&quot;Book =&quot;, self.Book).fetch(limit=999)
i = 0
for chapter in chapters:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 225)</p>
Unexpected indentation.</div>
<blockquote class="last">
<dl class="docutils">
<dt>if chapter.key() == self.key():</dt>
<dd><dl class="first last docutils">
<dt>if i &gt; 0:</dt>
<dd>return chapters[i-1]</dd>
</dl>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 228)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>i=i+1</p>
</blockquote>
</dd>
</dl>
</dd>
<dt>class ChapterForm(djangoforms.ModelForm):</dt>
<dd><dl class="first last docutils">
<dt>class Meta:</dt>
<dd>model = Chapter
fields = (&quot;Name&quot;, &quot;Title&quot;, &quot;Stage&quot;, &quot;Synopsis&quot;)</dd>
</dl>
</dd>
<dt>class ChapterFormForCreate(djangoforms.ModelForm):</dt>
<dd><dl class="first last docutils">
<dt>class Meta:</dt>
<dd>model = Chapter
fields = (&quot;Name&quot;, &quot;Title&quot;, &quot;Stage&quot;)</dd>
</dl>
</dd>
<dt>class Revision(db.Model):</dt>
<dd><p class="first">Book = db.ReferenceProperty(Book, collection_name=&quot;ChapterRevisions&quot;)
Chapter = db.ReferenceProperty(Chapter, collection_name=&quot;Revisions&quot;)
Version = db.IntegerProperty()
WordCount = db.IntegerProperty(default=0)
Text = db.TextProperty()
NoteFromAuthor = db.TextProperty()
Created =  db.DateTimeProperty(auto_now_add=True)
isPublished = db.BooleanProperty(default = True)</p>
<dl class="last docutils">
<dt>def calculateWordCount(self):</dt>
<dd><p class="first">if self.WordCount: return self.WordCount
else:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 253)</p>
Unexpected indentation.</div>
<blockquote class="last">
self.WordCount = utils.wordCount(self.Text)
return self.WordCount</blockquote>
</dd>
<dt>def markdownText(self):</dt>
<dd>return markdown2.markdown(self.Text)</dd>
<dt>def diffFromLatest(self):</dt>
<dd><p class="first">latest = self.Chapter.getLatestRevision()
if latest.key != self.key:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 262)</p>
Unexpected indentation.</div>
<blockquote>
return diff.textDiff(latest.Text, self.Text)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 263)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>return self.Text</dd>
</dl>
</dd>
<dt>def diffFromPrevious(self):</dt>
<dd><dl class="first last docutils">
<dt>if self.Version &gt; 1:</dt>
<dd>previousRevision = Revision.all().filter(&quot;Chapter =&quot;, self.Chapter).filter(&quot;Version =&quot;, self.Version-1).fetch(limit=1)[0]
return diff.textDiff(previousRevision.Text, self.Text)</dd>
<dt>else:</dt>
<dd>return self.Text</dd>
</dl>
</dd>
</dl>
</dd>
<dt>class Bookmark(db.Model):</dt>
<dd>Chapter = db.ReferenceProperty(Chapter, collection_name=&quot;Bookmarks&quot;)
Book = db.ReferenceProperty(Book, collection_name=&quot;Bookmarks&quot;)
Author = db.ReferenceProperty(membership.Member, collection_name=&quot;ReaderBookmarks&quot;)
Reader = db.ReferenceProperty(membership.Member, collection_name=&quot;Bookmarks&quot;)
When = db.DateTimeProperty(auto_now_add=True)</dd>
</dl>
<p>#Refactor: Replace with the Talk module
class Message(db.Model):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 282)</p>
Unexpected indentation.</div>
<blockquote>
<p>Chapter = db.ReferenceProperty(Chapter, collection_name=&quot;Feedback&quot;)
Book = db.ReferenceProperty(Book, collection_name=&quot;Feedback&quot;)
Author = db.ReferenceProperty(membership.Member, collection_name=&quot;FeedbackReceived&quot;, required=True)
From = db.ReferenceProperty(membership.Member, collection_name=&quot;FeedbackGiven&quot;, required=True)
Topic = db.StringProperty()
Text = db.TextProperty(required=True)
Sent = db.DateTimeProperty(auto_now_add=True)
ReplyTo = db.SelfReferenceProperty(collection_name=&quot;Replies&quot;)
isPrivate = db.BooleanProperty(default = False) # Only the author of the book will see this message
isForcedPrivate = db.BooleanProperty(default = False) # The author has forced this message to be private
targetType = db.StringProperty(required=True, choices=set([&quot;chapter&quot;, &quot;book&quot;, &quot;author&quot;]))</p>
<dl class="docutils">
<dt>def forcePrivate(self):</dt>
<dd>self.isPrivate = True
self.isForcedPrivate = True</dd>
</dl>
</blockquote>
<dl class="docutils">
<dt>class CoverForm(djangoforms.ModelForm):</dt>
<dd><dl class="first last docutils">
<dt>class Meta:</dt>
<dd>model = Cover
fields = (&quot;SampleTitle&quot;, &quot;TitleColor&quot;, &quot;isReusable&quot;)</dd>
</dl>
</dd>
</dl>
<p>#Refactor: should be secure for admins???
class CoverSetDefault(WrookRequestHandler):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 305)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 308)</p>
Unexpected indentation.</div>
<blockquote>
<p>key = self.request.get(&quot;selected&quot;)
if key:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 310)</p>
Unexpected indentation.</div>
<blockquote>
<p>cover = Cover.get(key)
if cover:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 312)</p>
Unexpected indentation.</div>
<blockquote>
<p>if not self.AppConfig: self.AppConfig = WrookAppConfig()
self.AppConfig.DefaultCover = cover
self.AppConfig.put()
page = proforma.SuccessPage()
page.Model={</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 317)</p>
Unexpected indentation.</div>
<blockquote>
&quot;Statement&quot;: _(&quot;The default cover has been set!&quot;),
&quot;ContinueURL&quot;: &quot;/Covers/&quot;,
&quot;ContinueLabel&quot;: _(&quot;Back to the covers&quot;)}</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 320)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.redirect(page.url())</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 321)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 322)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(500)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 323)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</blockquote>
<dl class="docutils">
<dt>class BookSetCover(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 329)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
selected = self.request.get(&quot;selected&quot;)
if selected and book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 332)</p>
Unexpected indentation.</div>
<blockquote>
<p>cover = Cover.get(selected)
if cover:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 334)</p>
Unexpected indentation.</div>
<blockquote>
<p>book.Cover = cover
book.put()
page = proforma.SuccessPage()
page.Model={</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 338)</p>
Unexpected indentation.</div>
<blockquote>
&quot;Statement&quot;: _(&quot;The cover has been changed!&quot;),
&quot;ContinueURL&quot;: &quot;/Books/&quot; + key,
&quot;ContinueLabel&quot;: _(&quot;Back to the book&quot;)}</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 341)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.redirect(page.url())</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 342)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 343)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(500)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 344)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class CoverEdit(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 350)</p>
Unexpected indentation.</div>
<blockquote>
<p>if key: cover = Cover.get(key)
else: cover = Cover()
form = CoverForm(instance=cover)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 354)</p>
Unexpected indentation.</div>
<blockquote>
'form': form
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 356)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/covers-edit.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 357)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 362)</p>
Unexpected indentation.</div>
<blockquote>
<p>if key: cover = Cover.get(key)
else: cover = Cover(CreatedBy=self.CurrentMember)
if self.request.get(&quot;doDelete&quot;):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 365)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>if cover.Books:</dt>
<dd>#Refactor: Replace this with the proforma module
self.response.out.write(_(&quot;This cover is already in use by other book. It was not deleted&quot;))</dd>
<dt>else:</dt>
<dd>db.delete(cover)
self.redirect(&quot;/Covers/&quot;)</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 371)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>return</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 372)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>form = CoverForm(self.request.POST, instance=cover)
if form.is_valid():</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 374)</p>
Unexpected indentation.</div>
<blockquote>
# Save the form, and redirect to the view page
entity = form.save(commit=False)
thumbnailImageProxy = self.request.get('thumbnailImageProxy')
if thumbnailImageProxy: entity.ThumbnailImage = db.Blob(thumbnailImageProxy)
entity.put()
self.redirect('/Covers/')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 380)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd>self.Model.update({'form': form})
self.render(&quot;views/cover-edit.html&quot;)</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 383)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class CoverThumbnail(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if key: cover = db.get(key)
elif self.AppConfig: cover = self.AppConfig.DefaultCover
else: cover = None
paramWidth = self.request.get(&quot;width&quot;)
if paramWidth == &quot;45&quot;:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 393)</p>
Unexpected indentation.</div>
<blockquote>
width = 45
height = 60</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 395)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>elif paramWidth == &quot;90&quot;:</dt>
<dd>width = 90
height = 120</dd>
<dt>elif paramWidth == &quot;180&quot;:</dt>
<dd>width = 180
height = 240</dd>
<dt>else:</dt>
<dd>width = 120
height = 160</dd>
<dt>if cover:</dt>
<dd><p class="first">imageKey = &quot;coverThumb%s-%s&quot; % (width, cover.key())
thumbnailData = memcache.get(imageKey)
if thumbnailData is None:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 408)</p>
Unexpected indentation.</div>
<blockquote>
image = images.Image(cover.ThumbnailImage)
image.resize(width, height)
thumbnailData = image.execute_transforms(output_encoding=images.PNG)
memcache.add(imageKey, thumbnailData)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 412)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">self.response.headers['content-type'] = &quot;image/jpg&quot;
self.response.headers['cache-control'] = &quot;public, max-age=1814400&quot; # 21 day cache
self.response.headers[&quot;Expires&quot;] = &quot;Thu, 01 Dec 2014 16&quot;
self.response.out.write(thumbnailData)</p>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 416)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.error(404)</p>
</dd>
</dl>
</dd>
<dt>class CoverImage(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
cover = Cover.get(key)
if cover:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 423)</p>
Unexpected indentation.</div>
<blockquote>
<p>image = images.Image(cover.ThumbnailImage)
image.rotate(0)
thumbnailData = image.execute_transforms(output_encoding=images.PNG)</p>
<p>self.response.headers['content-type'] = &quot;image/png&quot;
self.response.headers['cache-control'] = &quot;public, max-age=600&quot; # 10 minute cache
self.response.headers[&quot;Expires&quot;] = &quot;Thu, 01 Dec 2014 16&quot;
self.response.out.write(thumbnailData)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 431)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>self.error(404)</dd>
</dl>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
cover = Cover.get(key)
if cover:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 438)</p>
Unexpected indentation.</div>
<blockquote>
cover.ThumbnailImage = db.Blob(self.request.get('imageData'))
cover.put()
memcache.delete(&quot;coverImage-%s&quot; % cover.key())
memcache.delete(&quot;coverThumb45-%s&quot; % cover.key())
memcache.delete(&quot;coverThumb90-%s&quot; % cover.key())
memcache.delete(&quot;coverThumb120-%s&quot; % cover.key())
memcache.delete(&quot;coverThumb180-%s&quot; % cover.key())
self.response.out.write(&quot;Done!&quot;)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 446)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>self.error(404)</dd>
</dl>
</dd>
</dl>
</dd>
<dt>class CoverList(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 455)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'yourPrivateCovers': Cover.all().filter(&quot;CreatedBy =&quot;, self.CurrentMember).filter(&quot;isSharedWithEveryone =&quot;, False),
'yourSharedCovers': Cover.all().filter(&quot;CreatedBy =&quot;, self.CurrentMember).filter(&quot;isSharedWithEveryone =&quot;, True),
'allSharedCovers': Cover.all().filter(&quot;isSharedWithEveryone =&quot;, True)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 460)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/covers-list.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 461)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class CoverSelect(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 467)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'usage': self.request.get(&quot;usage&quot;),
'redirect': self.request.get(&quot;redirect&quot;),
'yourPrivateCovers': Cover.all().filter(&quot;CreatedBy =&quot;, self.CurrentMember).filter(&quot;isSharedWithEveryone =&quot;, False),
'yourSharedCovers': Cover.all().filter(&quot;CreatedBy =&quot;, self.CurrentMember).filter(&quot;isSharedWithEveryone =&quot;, True),
'allSharedCovers': Cover.all().filter(&quot;isSharedWithEveryone =&quot;, True)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 474)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/covers-select.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 475)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class CoverView(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 481)</p>
Unexpected indentation.</div>
<blockquote>
<p>cover = Cover.get(key)
if cover:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 483)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'cover': cover,
'picnikKey': picnikKey
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 487)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/covers-view.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 488)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 489)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class CoverShare(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 495)</p>
Unexpected indentation.</div>
<blockquote>
<p>cover = db.get(key)
if cover:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 497)</p>
Unexpected indentation.</div>
<blockquote>
cover.isSharedWithEveryone = True
cover.put()
self.redirect('/Covers/%s' % cover.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 500)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 501)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class CoverUnshare(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 507)</p>
Unexpected indentation.</div>
<blockquote>
<p>cover = db.get(key)
if cover:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 509)</p>
Unexpected indentation.</div>
<blockquote>
cover.isSharedWithEveryone = False
cover.put()
self.redirect('/Covers/%s' % cover.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 512)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 513)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Customize(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 519)</p>
Unexpected indentation.</div>
<blockquote class="last">
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>&quot;latestCovers&quot;: Cover.all().fetch(limit=3),
&quot;latestThemes&quot;: customize.Theme.all().fetch(limit=3)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 523)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render(&quot;views/customize.html&quot;)</p>
</blockquote>
</dd>
</dl>
</dd>
<dt>class Login(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 529)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'error': _(&quot;You are already logged in. In order to login again, you must first logout.&quot;)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 532)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/login-already.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 533)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd><p class="first">username = self.request.get(&quot;username&quot;)
password = self.request.get(&quot;password&quot;)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 537)</p>
Unexpected indentation.</div>
<blockquote>
'username': username,
'password': password
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 540)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">self.render('views/login.html')</p>
</dd>
</dl>
</dd>
<dt>def post(self):</dt>
<dd><p class="first">onRequest(self)
username = self.request.get(&quot;username&quot;)
password = self.request.get(&quot;password&quot;)
error = None
if username and password:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 548)</p>
Unexpected indentation.</div>
<blockquote>
<p>result = membership.memberLogin(self, username, password)
if not result.ErrorCode:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 550)</p>
Unexpected indentation.</div>
<blockquote>
self.redirect(&quot;/&quot;)
return</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 552)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd>error = _(&quot;&lt;strong&gt;Login failed:&lt;/strong&gt; &quot;) + result.ErrorMessage</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 554)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd>error = _(&quot;&lt;strong&gt;Login failed:&lt;/strong&gt; Username and password are both mandatory!&quot;)</dd>
<dt>self.Model.update({</dt>
<dd>'error': error,
'username': username,
'password': password
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 562)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render('views/login.html')</p>
</dd>
</dl>
</dd>
<dt>class Logout(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd>membership.logout(self)
self.redirect(&quot;/&quot;)</dd>
</dl>
</dd>
<dt>class Join(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 574)</p>
Unexpected indentation.</div>
<blockquote>
self.redirect(&quot;/&quot;) # Refactor: This special case should be handled: &quot;Accept invite while being already logged in&quot;</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 575)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd><p class="first">if key: invite = membership.Invite.get(key)
else: invite = membership.Invite()
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 579)</p>
Unexpected indentation.</div>
<blockquote>
&quot;invite&quot;: invite,
&quot;email&quot;: invite.Email.strip(),
&quot;firstname&quot;: invite.Firstname.strip(),
&quot;lastname&quot;: invite.Lastname.strip()
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 584)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">self.render('views/join.html')</p>
</dd>
</dl>
</dd>
<dt>def post(self, key): #Refactor: This handler should be moved to the membership module and actuel business logic should be in separate methods</dt>
<dd><p class="first">onRequest(self)
if key: invite = membership.Invite.get(key)
else: invite = membership.Invite()
username = self.request.get(&quot;Username&quot;)
email = self.request.get(&quot;Email&quot;)
firstname = self.request.get(&quot;Firstname&quot;)
lastname = self.request.get(&quot;Lastname&quot;)
gender = self.request.get(&quot;Gender&quot;)
preferedLanguage = self.request.get(&quot;PreferedLanguage&quot;)
isValid = True
if (firstname == &quot;&quot; or lastname == &quot;&quot; or email == &quot;&quot; or username == &quot;&quot;):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 598)</p>
Unexpected indentation.</div>
<blockquote>
isValid = False
error = _(&quot;Username, email, firstname and lastname are madatory!&quot;)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 600)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>elif (membership.getMemberFromCredentials(email)): #Refactor: This constraint should be built into the Member entity</dt>
<dd>isValid = False
error = _(&quot;This email address is already used by another member&quot;)</dd>
<dt>elif (membership.getMemberFromCredentials(username)): #Refactor: This constraint should be built into the Member entity</dt>
<dd>isValid = False
error = _(&quot;This username address is already used by another member&quot;)</dd>
<dt>if (not isValid):</dt>
<dd><dl class="first docutils">
<dt>self.Model.update({</dt>
<dd>'username': username,
'email': email,
'firstname': firstname,
'lastname': lastname,
'gender': gender,
'preferedLanguage': preferedLanguage,
'error': error
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 616)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render(&quot;views/join.html&quot;)</p>
</dd>
<dt>else:</dt>
<dd><dl class="first docutils">
<dt>member = membership.Member(</dt>
<dd>Username = username,
Email = email,
Firstname = firstname,
Lastname = lastname,
Gender = gender,
PreferedLanguage = preferedLanguage,
)</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 626)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>member.put()
member.resetPassword()
member.sendPassword()
if invite:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 630)</p>
Unexpected indentation.</div>
<blockquote>
invite.AcceptedMember = member
invite.Status = &quot;accepted&quot;
invite.WhenAccepted = datetime.datetime.now()
invite.put()</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 634)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">self.redirect(&quot;/ResetPassword/%s&quot; % member.key())</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>class AccountView(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 641)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(self.CurrentMember)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 643)</p>
Unexpected indentation.</div>
<blockquote>
'member': self.CurrentMember
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 645)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/viewAccount.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 646)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class EditAccount(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 652)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(self.CurrentMember)
if self.CurrentMember.ProfilePhoto: hasProfilePhoto = True
else: hasProfilePhoto = False
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 656)</p>
Unexpected indentation.</div>
<blockquote>
'key': self.CurrentMember.key(),
'firstname': self.CurrentMember.Firstname,
'lastname': self.CurrentMember.Lastname,
'hasProfilePhoto': hasProfilePhoto,
'gender': self.CurrentMember.Gender,
'preferedLanguage': self.CurrentMember.PreferedLanguage,
'about': self.CurrentMember.About
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 664)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/editAccount.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 665)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 670)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(self.CurrentMember)
firstname = self.request.get(&quot;Firstname&quot;)
lastname = self.request.get(&quot;Lastname&quot;)
preferedLanguage = self.request.get(&quot;PreferedLanguage&quot;)
gender = self.request.get(&quot;Gender&quot;)
about = self.request.get(&quot;About&quot;)
tmpProfilePhoto = self.request.get(&quot;profilePhotoProxy&quot;)
if tmpProfilePhoto: profilePhoto = db.Blob(tmpProfilePhoto)
else: profilePhoto = None
if (firstname == &quot;&quot; or lastname == &quot;&quot;):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 680)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'firstname': firstname,
'lastname': lastname,
'preferedLanguage': preferedLanguage,
'gender': gender,
'about': about,
'error': _(&quot;Firstname and lastname are madatory! You will also have to re-upload your photo!&quot;) #Refacfor: There should be a way not to forget the photo... temp area?
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 688)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/editAccount.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 689)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd>member = self.CurrentMember
member.Firstname = firstname
member.Lastname = lastname
member.PreferedLanguage = preferedLanguage
member.Gender = gender
member.About = about
if profilePhoto: member.ProfilePhoto = profilePhoto
member.put()
self.redirect(&quot;/Account/View&quot;)</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 699)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class AccountChangeProfilePhoto(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 705)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(self.CurrentMember)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 707)</p>
Unexpected indentation.</div>
<blockquote>
'member': self.CurrentMember,
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 709)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/account-changePhoto.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 710)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 715)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(self.CurrentMember)
tmpProfilePhoto = self.request.get(&quot;profilePhotoProxy&quot;)
if tmpProfilePhoto: profilePhoto = db.Blob(tmpProfilePhoto)
else: profilePhoto = None
if not profilePhoto:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 720)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'error': _(&quot;No file were uploaded!&quot;) #Refacfor: There should be a way not to forget the photo... temp area?
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 723)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/editAccount.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 724)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd>member = self.CurrentMember
member.ProfilePhoto = profilePhoto
member.put()
member.flushCache()
self.redirect(&quot;/Account/View&quot;)</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 730)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class AccountChangePassword(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 737)</p>
Unexpected indentation.</div>
<blockquote>
self.setVisitedMember(self.CurrentMember)
self.render('views/account-changePassword.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 739)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 744)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(self.CurrentMember)
oldPassword = self.request.get(&quot;oldPassword&quot;)
newPassword = self.request.get(&quot;newPassword&quot;)
if oldPassword == self.CurrentMember.Password and newPassword:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 748)</p>
Unexpected indentation.</div>
<blockquote>
self.CurrentMember.Password = newPassword
self.CurrentMember.put()
self.CurrentMember.flushCache()
self.redirect(&quot;/Account/View&quot;)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 752)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd><dl class="first docutils">
<dt>self.Model.update({</dt>
<dd>'error': _(&quot;Changing password failed! You have either not entered a new password or the old one does not match.&quot;)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 756)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render('views/account-changePassword.html')</p>
</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 757)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Home(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 763)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(self.CurrentMember)
BeginnerBook = []
BeginnerBookmark = []
hasReadWrookForBeginners = False
# Refactor: Put in a cached method
# BeginnerBook = Book.all().filter(&quot;Slug =&quot;, &quot;wrook-for-beginners&quot;).fetch(limit=1)
# if len(BeginnerBook) &gt; 0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 770)</p>
Unexpected indentation.</div>
<blockquote>
# BeginnerBookmark = Bookmark.all().filter(&quot;Reader = &quot;, self.CurrentMember).filter(&quot;Book =&quot;, BeginnerBook[0]).fetch(limit=1)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 771)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt># if len(BeginnerBookmark) &gt; 0:</dt>
<dd># hasReadWrookForBeginners = True</dd>
</dl>
<p>cacheKey = &quot;wrookMemberPosts-%s&quot; % self.CurrentMember.key()
posts = memcache.get(cacheKey)
if not posts:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 777)</p>
Unexpected indentation.</div>
<blockquote>
posts = self.CurrentMember.ReceivedStoryPosts.order(&quot;-WhenOccured&quot;).fetch(limit=50)
memcache.add(cacheKey, posts)</blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>&quot;posts&quot;: posts,
&quot;hasReadWrookForBeginners&quot;: hasReadWrookForBeginners
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 784)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/memberHome.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 785)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>self.render('views/visitorHome.html')</dd>
</dl>
</dd>
</dl>
</dd>
<dt>class MembersFeed(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 792)</p>
Unexpected indentation.</div>
<blockquote>
<p>member = membership.Member.get(key)
if member:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 794)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(member)
posts = member.ReceivedStoryPosts.order(&quot;-WhenOccured&quot;).filter(&quot;Member = &quot;, member.key()).fetch(limit=40)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 797)</p>
Unexpected indentation.</div>
<blockquote>
&quot;posts&quot;: posts
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 799)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/members-stories.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 800)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 801)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class ViewBook(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 807)</p>
Unexpected indentation.</div>
<blockquote>
<p>#Before loading a book from the key, lets try to find it from the Slug
book = Book.all().filter(&quot;Slug =&quot;, key).fetch(limit=1)
if len(book) &gt; 0: book = book[0]
else: book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 812)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapters = Chapter.all().filter(&quot;Book =&quot;, book).order(&quot;Number&quot;).fetch(limit=999)
chapterCount = len(chapters)
if book.Author:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 815)</p>
Unexpected indentation.</div>
<blockquote>
self.setVisitedMember(book.Author)
userIsAuthor = (self.CurrentMember.key() == book.Author.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 817)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: userIsAuthor = False
if userIsAuthor or self.CurrentMember.isAdmin: userCanEdit = True
else: userCanEdit = False
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 821)</p>
Unexpected indentation.</div>
<blockquote>
&quot;book&quot;: book,
&quot;chapters&quot;: chapters,
&quot;firstChapter&quot;: book.firstChapter(),
&quot;chapterCount&quot;: chapterCount,
&quot;userIsAuthor&quot;: userIsAuthor,
&quot;userCanEdit&quot;: userCanEdit
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 828)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/books-view.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 829)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 830)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class MembersProfile(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 837)</p>
Unexpected indentation.</div>
<blockquote>
<p>visitedMember = membership.Member.get(key)
if visitedMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 839)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(visitedMember)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 841)</p>
Unexpected indentation.</div>
<blockquote>
&quot;now&quot;: datetime.datetime.now()
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 843)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/MembersProfile.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 844)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 845)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
</dl>
<p>#Refactor: Put back in the chapter object
def deleteChapter(chapter):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 849)</p>
Unexpected indentation.</div>
<blockquote>
db.delete(chapter.Feedback)
db.delete(chapter.Revisions)
db.delete(chapter.Bookmarks)
db.delete(chapter)</blockquote>
<p>#Refactor: Put back in the book object
def deleteBook(book):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 856)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>for chapter in book.Chapters:</dt>
<dd>deleteChapter(chapter)</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 858)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>db.delete(book.Feedback)
db.delete(book.Bookmarks)
db.delete(book)</p>
</blockquote>
<dl class="docutils">
<dt>class DeleteChapter(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 866)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 868)</p>
Unexpected indentation.</div>
<blockquote>
<p>userIsAuthor = (self.CurrentMember.key() == chapter.Book.Author.key())
if userIsAuthor:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 870)</p>
Unexpected indentation.</div>
<blockquote>
self.Model.update({&quot;chapter&quot;: chapter})
self.render('views/deleteChapter.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 872)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: return</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 873)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 874)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 879)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 881)</p>
Unexpected indentation.</div>
<blockquote>
<p>userIsAuthor = (self.CurrentMember.key() == chapter.Book.Author.key())
if userIsAuthor:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 883)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>if (self.request.get(&quot;doDelete&quot;) != &quot;&quot; and self.request.get(&quot;confirmDelete&quot;) == &quot;yes&quot;):</dt>
<dd>deleteChapter(chapter)
self.redirect(&quot;/Books/%s&quot; % chapter.Book.key())</dd>
<dt>else:</dt>
<dd>self.redirect(&quot;/Chapter/Delete/%s&quot; % chapter.key())</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 888)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: return</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 889)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 890)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class PasswordSent(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
member = membership.Member.get(key)
if member:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 897)</p>
Unexpected indentation.</div>
<blockquote>
self.Model.update({&quot;member&quot;: member})
self.render('views/passwordSent.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 899)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.error(404)</p>
</dd>
</dl>
</dd>
<dt>class ResetPassword(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if key:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 905)</p>
Unexpected indentation.</div>
<blockquote>
<p>member = membership.Member.get(key)
if member:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 907)</p>
Unexpected indentation.</div>
<blockquote>
member.resetPassword()
member.sendPassword()
self.Model.update({&quot;member&quot;: member})
self.redirect('/PasswordSent/%s' % member.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 911)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 912)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>self.render(&quot;views/resetPassword.html&quot;)</dd>
</dl>
</dd>
<dt>def post(self, key):</dt>
<dd><dl class="first docutils">
<dt>if not key:</dt>
<dd><p class="first">usernameOrEmail = self.request.get(&quot;usernameOrEmail&quot;)
if usernameOrEmail:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 919)</p>
Unexpected indentation.</div>
<blockquote>
<p>member = membership.getMemberFromCredentials(usernameOrEmail)
if member:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 921)</p>
Unexpected indentation.</div>
<blockquote>
member.resetPassword()
member.sendPassword()
self.Model.update({&quot;member&quot;: member})
self.redirect('/PasswordSent/%s' % member.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 925)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd>self.Model.update({&quot;error&quot;: _(&quot;No member found with this username or email address!&quot;)})
self.render(&quot;views/resetPassword.html&quot;)</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 928)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="last docutils">
<dt>else:</dt>
<dd>self.Model.update({&quot;error&quot;: _(&quot;No member found with this username or email address!&quot;)})
self.render(&quot;views/resetPassword.html&quot;)</dd>
</dl>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 931)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.error(404)</p>
</dd>
</dl>
</dd>
<dt>class SendPassword(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
member = membership.Member.get(key)
if member:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 938)</p>
Unexpected indentation.</div>
<blockquote>
member.sendPassword()
self.Model.update({&quot;member&quot;: member})
self.redirect('/PasswordSent/%s' % member.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 941)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.error(404)</p>
</dd>
</dl>
</dd>
<dt>class DeleteBook(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 947)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 949)</p>
Unexpected indentation.</div>
<blockquote>
<p>userIsAuthor = (self.CurrentMember.key() == book.Author.key())
if userIsAuthor:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 951)</p>
Unexpected indentation.</div>
<blockquote>
self.Model.update({&quot;book&quot;: book})
self.render('views/deleteBook.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 953)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: return</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 954)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 955)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 960)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 962)</p>
Unexpected indentation.</div>
<blockquote>
<p>userIsAuthor = (self.CurrentMember.key() == book.Author.key())
if userIsAuthor:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 964)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>if (self.request.get(&quot;doDelete&quot;) != &quot;&quot; and self.request.get(&quot;confirmDelete&quot;) == &quot;yes&quot;):</dt>
<dd>deleteBook(book)
self.redirect(&quot;/&quot;)</dd>
<dt>else:</dt>
<dd>self.redirect(&quot;/Books/Delete/%s&quot; % book.key())</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 969)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: return</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 970)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 971)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class ViewChapter(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 977)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 979)</p>
Unexpected indentation.</div>
<blockquote>
<p>userIsAuthor = (self.CurrentMember.key() == chapter.Book.Author.key())
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 981)</p>
Unexpected indentation.</div>
<blockquote>
&quot;chapter&quot;: chapter,
&quot;userIsAuthor&quot;: userIsAuthor
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 984)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>chapter.setBookmark(self.CurrentMember)
self.render('views/viewChapter.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 986)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 987)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class EditChapterOptions(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get( self, key ):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 994)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 996)</p>
Unexpected indentation.</div>
<blockquote>
<p>form = ChapterForm(instance=chapter)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 998)</p>
Unexpected indentation.</div>
<blockquote>
&quot;chapter&quot;: chapter,
&quot;form&quot;: form
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1001)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/books-chapter-edit.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1002)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1003)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1008)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1010)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>if self.request.get(&quot;doDelete&quot;):</dt>
<dd>self.redirect('/Chapter/Delete/%s' % chapter.key())
return</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1013)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>form = ChapterForm(data=self.request.POST, instance=chapter)
if form.is_valid():</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1015)</p>
Unexpected indentation.</div>
<blockquote>
# Save the form, and redirect to the view page
entity = form.save(commit=False)
entity.put()
self.redirect('/ViewChapter/%s' % chapter.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1019)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd><dl class="first docutils">
<dt>self.Model.update({</dt>
<dd>'chapter': chapter,
'form': form
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1024)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render('views/books-chapter-edit.html')</p>
</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1025)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1026)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Books(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1032)</p>
Unexpected indentation.</div>
<blockquote>
<p>stage = self.request.get(&quot;stage&quot;)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1034)</p>
Unexpected indentation.</div>
<blockquote>
'true': True,
'false': False
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1037)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>if stage:</dt>
<dd>self.Model.update({'books': Book.all().filter(&quot;Stage =&quot;, stage)})
self.Model.update({'stage': stage})</dd>
<dt>else:</dt>
<dd>self.Model.update({'books': Book.all()})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1042)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/books.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1043)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Books_Edit(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1049)</p>
Unexpected indentation.</div>
<blockquote>
<p>if key == &quot;&quot;: book = Book(Author=self.CurrentMember)
else: book = Book.get(key)
form = BookForm(instance=book)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1053)</p>
Unexpected indentation.</div>
<blockquote>
'book': book,
'form': form
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1056)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/books-edit.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1057)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1062)</p>
Unexpected indentation.</div>
<blockquote>
<p>if key == &quot;&quot;: book = Book(Author=self.CurrentMember)
else: book = Book.get(key)
form = BookForm(data=self.request.POST, instance=book)
if form.is_valid():</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1066)</p>
Unexpected indentation.</div>
<blockquote>
# Save the form, and redirect to the view page
entity = form.save(commit=False)
entity.put()
if key == &quot;&quot;: self.redirect('/NewChapter/%s' % book.key())
else: self.redirect('/Books/%s' % book.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1071)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd><dl class="first docutils">
<dt>self.Model.update({</dt>
<dd>'book': book,
'form': form
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1076)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render(&quot;views/books-edit.html&quot;)</p>
</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1077)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Book_ReorderChapters(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">chapterCount = utils.buildCountingList(50)
onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1084)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1086)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'chapterCount': chapterCount,
'book': book,
'chapters': book.Chapters.order(&quot;Number&quot;)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1091)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/books-reorderChapters.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1092)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1093)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1098)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapterCount = utils.buildCountingList(50)
book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1101)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>for chapter in book.Chapters.order(&quot;Number&quot;):</dt>
<dd><p class="first">chapterSet = self.request.get(&quot;chapter.%s&quot; % chapter.key())
title = self.request.get(&quot;chapter.%s.title&quot; % chapter.key())
name = self.request.get(&quot;chapter.%s.name&quot; % chapter.key())
order = self.request.get(&quot;chapter.%s.order&quot; % chapter.key())
if chapterSet:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1107)</p>
Unexpected indentation.</div>
<blockquote>
if chapter.Name: chapter.Name = name
else: chapter.Name = &quot;Unnamed chapter&quot;
chapter.Title = title
chapter.Number = int(order)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1111)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">chapter.put()</p>
</dd>
<dt>if self.request.get(&quot;update&quot;):</dt>
<dd><dl class="first docutils">
<dt>self.Model.update({</dt>
<dd>'chapterCount': chapterCount,
'book': book,
'chapters': book.Chapters.order(&quot;Number&quot;)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1118)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render('views/books-reorderChapters.html')</p>
</dd>
<dt>if self.request.get(&quot;done&quot;):</dt>
<dd>self.redirect('/Books/%s' % book.key())</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1121)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1122)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Books_Edit_License(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1128)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1130)</p>
Unexpected indentation.</div>
<blockquote>
<p>form = BookLicenseForm(instance=book)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1132)</p>
Unexpected indentation.</div>
<blockquote>
'book': book,
'form': form
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1135)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/books-edit-license.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1136)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1137)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1142)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1144)</p>
Unexpected indentation.</div>
<blockquote>
<p>form = BookLicenseForm(data=self.request.POST, instance=book)
if form.is_valid():</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1146)</p>
Unexpected indentation.</div>
<blockquote>
# Save the form, and redirect to the view page
entity = form.save(commit=False)
entity.put()
self.redirect('/Books/%s' % book.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1150)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd><dl class="first docutils">
<dt>self.Model.update({</dt>
<dd>'book': book,
'form': form
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1155)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render(&quot;views/books-edit-license.html&quot;)</p>
</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1156)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1157)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Members(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1163)</p>
Unexpected indentation.</div>
<blockquote>
members = membership.Member.all().fetch(limit=200)
self.Model.update({'members': members})
self.render('views/members.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1166)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class MembersCoversList(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1172)</p>
Unexpected indentation.</div>
<blockquote>
<p>visitedMember = membership.Member.get(key)
if visitedMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1174)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(visitedMember)
sharedCovers = visitedMember.Covers.filter(&quot;isSharedWithEveryone =&quot;, True).fetch(limit=100)
privateCovers = visitedMember.Covers.filter(&quot;isSharedWithEveryone =&quot;, False).fetch(limit=100)
permissionMemberCanSeePrivateCovers = self.CurrentMember.isAdmin or self.CurrentMember == self.VisitedMember
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1179)</p>
Unexpected indentation.</div>
<blockquote>
'sharedCovers': sharedCovers,
'privateCovers': privateCovers,
'permissionMemberCanSeePrivateCovers': permissionMemberCanSeePrivateCovers
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1183)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/members-covers-list.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1184)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1185)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class MembersBooksList(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1191)</p>
Unexpected indentation.</div>
<blockquote>
<p>visitedMember = membership.Member.get(key)
if visitedMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1193)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(visitedMember)
books = visitedMember.Books.fetch(limit=999)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1196)</p>
Unexpected indentation.</div>
<blockquote>
'books': books
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1198)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/members-books-list.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1199)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1200)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class MembersReadingsList(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1206)</p>
Unexpected indentation.</div>
<blockquote>
<p>visitedMember = membership.Member.get(key)
if visitedMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1208)</p>
Unexpected indentation.</div>
<blockquote>
<p>self.setVisitedMember(visitedMember)
bookmarks = visitedMember.Bookmarks.fetch(limit=999)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1211)</p>
Unexpected indentation.</div>
<blockquote>
'bookmarks': bookmarks
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1213)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/members-bookmarks-list.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1214)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1215)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class BookReaders(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1222)</p>
Unexpected indentation.</div>
<blockquote>
self.Model.update({'book': Book.get(key)})
self.render('views/readers.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1224)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class NewChapter(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1230)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1232)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter(Book=book)
form = ChapterFormForCreate(instance=chapter)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1235)</p>
Unexpected indentation.</div>
<blockquote>
'book': book,
'form': form
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1238)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/books-chapter-new.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1239)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1240)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1245)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1247)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter(Book=book)
form = ChapterFormForCreate(data=self.request.POST, instance=chapter)
if form.is_valid():</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1250)</p>
Unexpected indentation.</div>
<blockquote>
# Save the form, and redirect to the view page
entity = form.save(commit=False)
entity.put()
self.redirect(&quot;/Typewriter/%s&quot; % chapter.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1254)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd><dl class="first docutils">
<dt>self.Model.update({</dt>
<dd>'form': form,
'book': book
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1259)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">self.render(&quot;views/books-chapter-new.html&quot;)</p>
</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1260)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1261)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class FeedbackBook(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1267)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = Book.get(key)
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1269)</p>
Unexpected indentation.</div>
<blockquote>
<p>messages = book.Feedback.order(&quot;-Sent&quot;)
self.Model.update({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1271)</p>
Unexpected indentation.</div>
<blockquote>
'book': book,
'messages': messages,
'targetType': 'book'
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1275)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>self.render('views/messages.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1276)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1277)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Revisions_List(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1284)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1286)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'chapter': chapter,
'revisions': chapter.Revisions.order(&quot;-Version&quot;).fetch(limit=999)
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1290)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/revisions-list.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1291)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1292)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Revisions_View(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key, version):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1298)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1300)</p>
Unexpected indentation.</div>
<blockquote>
<p>revision = chapter.Revisions.filter(&quot;Version =&quot;, int(version)).fetch(limit=1)
if len(revision) &gt; 0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1302)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>self.Model.update({</dt>
<dd>'chapter': chapter,
'revision': revision[0]
})</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1306)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.render('views/revisions-view.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1307)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1308)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1309)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class PostMessage(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def post(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1315)</p>
Unexpected indentation.</div>
<blockquote>
<p>topic = self.request.get(&quot;Topic&quot;)
if topic == &quot;&quot;:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1317)</p>
Unexpected indentation.</div>
<blockquote>
topic = None</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1318)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>text = self.request.get(&quot;Text&quot;)
targetType = self.request.get(&quot;TargetType&quot;)
isPrivate = (self.request.get(&quot;isPrivate&quot;) == &quot;true&quot;)
if targetType == &quot;book&quot;:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1322)</p>
Unexpected indentation.</div>
<blockquote>
<p>book = db.get(self.request.get(&quot;Book&quot;))
if book:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1324)</p>
Unexpected indentation.</div>
<blockquote>
<p>author = book.Author
message = Message(</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1326)</p>
Unexpected indentation.</div>
<blockquote>
Book = book,
Author = author,
From = self.CurrentMember,
Topic = topic,
Text = text,
isPrivate = isPrivate,
targetType = targetType
)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1334)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>message.put()
story = StoryMemberPostMessageToABook()
occurence = story.createOccurence({</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1337)</p>
Unexpected indentation.</div>
<blockquote>
&quot;member&quot;: self.CurrentMember,
&quot;message&quot;: message,
&quot;book&quot;: book
})</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1341)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>occurence.publish()
self.redirect(self.request.get(&quot;ComebackUrl&quot;))</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1343)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1344)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1345)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class DeleteMessage(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1351)</p>
Unexpected indentation.</div>
<blockquote>
<p>message = db.get(key)
if message:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1353)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>if message.From.key() == self.CurrentMember.key():</dt>
<dd>message.delete()</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1355)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.redirect(self.request.get(&quot;ComebackUrl&quot;))</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1356)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1357)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class Typewriter(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1363)</p>
Unexpected indentation.</div>
<blockquote>
<p>chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1365)</p>
Unexpected indentation.</div>
<blockquote>
self.Model.update({&quot;chapter&quot;: chapter})
self.render('views/typewriter.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1367)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1368)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1373)</p>
Unexpected indentation.</div>
<blockquote>
<p>text = self.request.get(&quot;text&quot;)
chapter = Chapter.get(key)
if chapter:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1376)</p>
Unexpected indentation.</div>
<blockquote>
chapter.addRevision(text)
self.redirect(&quot;/ViewChapter/%s&quot; % chapter.key())</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1378)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(404)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1379)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class AdminCommands(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1385)</p>
Unexpected indentation.</div>
<blockquote>
self.render('views/admin-commands.html')</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1386)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def post(self, key):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1391)</p>
Unexpected indentation.</div>
<blockquote>
<dl class="docutils">
<dt>if (key == &quot;doDefaultAllBookStatus&quot;):</dt>
<dd>operationResults = self.doDefaultAllBookStatus()</dd>
<dt>if (key == &quot;doDefaultAllChapterNumberTo0&quot;):</dt>
<dd>operationResults = self.doDefaultAllChapterNumberTo0()</dd>
<dt>if (key == &quot;doLoadLicenseTypes&quot;):</dt>
<dd>operationResults = self.doLoadLicenseTypes()</dd>
<dt>else:</dt>
<dd>operationResults = CommandResult(ErrorCode=1, Message=_(&quot;No commands have been processed. Missing parameters!&quot;))</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1399)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>self.Model.update({&quot;operationResults&quot;: operationResults})
self.render('views/admin-commands.html')</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1401)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
<dt>def doDefaultAllBookStatus(self):</dt>
<dd><dl class="first docutils">
<dt>for book in Book.all():</dt>
<dd><p class="first">if book.Stage == &quot;planning&quot;: book.Stage = &quot;writing&quot;
for chapter in book.Chapters:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1407)</p>
Unexpected indentation.</div>
<blockquote>
if chapter.Stage == &quot;planning&quot;: chapter.Stage = &quot;writing&quot;
chapter.put()</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1409)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">book.put()</p>
</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1410)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">result = CommandResult(ErrorCode=0, Message=_(&quot;Empty status properties of all books and chapters have been defaulted!&quot;))
return result</p>
</dd>
<dt>def doLoadLicenseTypes(self):</dt>
<dd>licensing.LoadLicenseTypes()
result = CommandResult(ErrorCode=0, Message=_(&quot;All license types have been loaded into the database!&quot;))
return result</dd>
<dt>def doDefaultAllChapterNumberTo0(self):</dt>
<dd><dl class="first docutils">
<dt>for chapter in Chapter.all():</dt>
<dd>chapter.Number=0
chapter.put()</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1422)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p class="last">result = CommandResult(ErrorCode=0, Message=_(&quot;All chapter numbers have been reseted to 0!&quot;))
return result</p>
</dd>
</dl>
</dd>
<dt>class CommandResult(db.Model):</dt>
<dd>ErrorCode = db.IntegerProperty(default=&quot;0&quot;) # 0 = no errors
Message = db.TextProperty(default=&quot;&quot;)</dd>
<dt>class Command(db.Model):</dt>
<dd>Title = db.StringProperty(default=&quot;&quot;)
Description = db.TextProperty(default=&quot;&quot;)
Code = db.TextProperty(default=&quot;&quot;)</dd>
<dt>class FlushCache(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1438)</p>
Unexpected indentation.</div>
<blockquote>
memcache.flush_all()
#Refactor:Use the proforma module for a confirmation
self.response.out.write(_(&quot;Congratulations... you flushed the cache!&quot;))
#Post this as a story for admins
story = StorySiteCacheIsFlushed()
occurence = story.createOccurence({&quot;member&quot;: self.CurrentMember })
occurence.publish()</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1445)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>def getDefaultTheme(): #Refactor: Move back to the Customize module??</dt>
<dd><p class="first">defaultTheme = memcache.get(&quot;wrookDefaultTheme&quot;)
if not defaultTheme:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1450)</p>
Unexpected indentation.</div>
<blockquote>
<p>defaultMoments = Moment.all().filter(&quot;isDefault =&quot;, True).order(&quot;-Priority&quot;).fetch(limit=1)
if len(defaultMoments)==0:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1452)</p>
Unexpected indentation.</div>
<blockquote>
return None</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1453)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl class="docutils">
<dt>else:</dt>
<dd>defaultTheme = defaultMoments[0].Theme
memcache.add(&quot;wrookDefaultTheme&quot;, defaultTheme)</dd>
</dl>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1456)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">return defaultTheme</p>
</dd>
<dt>class SetDefaultTheme(WrookRequestHandler): #Refactor: Move back to the Customize module</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1462)</p>
Unexpected indentation.</div>
<blockquote>
<p>theme = customize.Theme.get(self.request.get(&quot;selectedTheme&quot;))
if theme and self.CurrentMember.isAdmin:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1464)</p>
Unexpected indentation.</div>
<blockquote>
<p>db.delete(Moment.all().filter(&quot;isDefault =&quot;, True)) # Removes the current default moments
moment = Moment(</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1466)</p>
Unexpected indentation.</div>
<blockquote>
Title = &quot;Default moment&quot;,
Theme = theme,
isDefault = True
)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1470)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>moment.put()
memcache.delete(&quot;wrookDefaultTheme&quot;) # Invalidates the cached default theme
self.redirect(&quot;/Themes&quot;)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1473)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>else: self.error(500)</p>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1474)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
<dt>class WrookApplication(webapp.Application): # decouppling for future use</dt>
<dd>pass</dd>
</dl>
<p>#============================================================================
# ABOUT</p>
<dl class="docutils">
<dt>class About_OpenSoureLicense(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd>onRequest(self)
self.render(&quot;views/about-openSourceLicense.html&quot;)</dd>
</dl>
</dd>
<dt>class About_OpenSoureAttribution(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd>onRequest(self)
self.render(&quot;views/about-openSourceAttribution.html&quot;)</dd>
</dl>
</dd>
<dt>class About_CPAL(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd>onRequest(self)
self.render(&quot;views/about-CPAL.html&quot;)</dd>
</dl>
</dd>
<dt>class About_who(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd>onRequest(self)
self.render(&quot;views/about-who.html&quot;)</dd>
</dl>
</dd>
<dt>class Suggestions(WrookRequestHandler):</dt>
<dd><dl class="first last docutils">
<dt>def get(self):</dt>
<dd><p class="first">onRequest(self)
if self.CurrentMember:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1507)</p>
Unexpected indentation.</div>
<blockquote>
self.setVisitedMember(self.CurrentMember)
self.render(&quot;views/member-suggestions.html&quot;)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1509)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">else: self.requestLogin()</p>
</dd>
</dl>
</dd>
</dl>
<p>#============================================================================
# STORIES</p>
<dl class="docutils">
<dt>class StoryMemberStartReadingBook(stories.Story):</dt>
<dd><p class="first">ID = &quot;MemberStartReadingBook&quot;
TitleTemplate = _('&lt;a href=&quot;/Members/$MemberKey&quot;&gt;$MemberFullname&lt;/a&gt; started reading &lt;a href=&quot;/Books/$BookKey&quot;&gt;$BookTitle&lt;/a&gt;')
BodyTemplate = &quot;&quot;
Icon = &quot;book-open.png&quot;</p>
<dl class="last docutils">
<dt>def getTitle(self, params):</dt>
<dd><p class="first">member = params[&quot;member&quot;]
book = params[&quot;book&quot;]
data = {</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1526)</p>
Unexpected indentation.</div>
<blockquote>
&quot;MemberFullname&quot;: member.fullname(),
&quot;MemberKey&quot;: member.key(),
&quot;BookTitle&quot;: book.Title,
&quot;BookKey&quot;: book.key()
}</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1531)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">template = Template(self.TitleTemplate)
return template.safe_substitute(data)</p>
</dd>
<dt>def getTargets(self, params): #Get the list of member who will receive the story posts</dt>
<dd>targets = []
targets.append(params[&quot;book&quot;].Author)
targets.append(params[&quot;member&quot;])
return targets</dd>
</dl>
</dd>
<dt>class StoryMemberPostMessageToABook(stories.Story):</dt>
<dd>ID = &quot;MemberPostMessageToABook&quot;
TitleTemplate = _('&lt;a href=&quot;/Members/$MemberKey&quot;&gt;$MemberFullname&lt;/a&gt; left a comment on &lt;a href=&quot;/Books/$BookKey&quot;&gt;$BookTitle&lt;/a&gt;')
BodyTemplate = _('''</dd>
<dt>&lt;a href=&quot;/Feedback/Book/$BookKey&quot; style=&quot;float: right; margin-left: 15px;&quot;&gt;</dt>
<dd>&lt;img width=&quot;45&quot; src=&quot;$CoverImage&quot;/&gt;</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1546)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>&lt;/a&gt;
&lt;a href=&quot;/Members/$MemberKey&quot; style=&quot;float: left; margin-right: 15px;&quot;&gt;</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1548)</p>
Unexpected indentation.</div>
<blockquote>
&lt;img width=&quot;30&quot; src=&quot;$MemberAvatar&quot;/&gt;</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1549)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>&lt;/a&gt;
&lt;strong&gt;&lt;a href=&quot;/Feedback/Book/$BookKey&quot;&gt;The message&lt;/a&gt; said: $MessageTitle &lt;/strong&gt;&lt;br /&gt;&quot;&amp;#160;$MessageBody&amp;#160;&quot;
''')</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1552)</p>
Unexpected indentation.</div>
<blockquote>
<p>Icon = &quot;comment.png&quot;</p>
<dl class="docutils">
<dt>def getTitle(self, params):</dt>
<dd><p class="first">member = params[&quot;member&quot;]
book = params[&quot;book&quot;]
data = {</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1558)</p>
Unexpected indentation.</div>
<blockquote>
&quot;MemberFullname&quot;: member.fullname(),
&quot;MemberKey&quot;: member.key(),
&quot;BookTitle&quot;: book.Title,
&quot;BookKey&quot;: book.key()
}</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1563)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">template = Template(self.TitleTemplate)
return template.safe_substitute(data)</p>
</dd>
<dt>def getBody(self, params):</dt>
<dd><p class="first">member = params[&quot;member&quot;]
message = params[&quot;message&quot;]
book = params[&quot;book&quot;]
data = {</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1571)</p>
Unexpected indentation.</div>
<blockquote>
&quot;MemberFullname&quot;: member.fullname(),
&quot;MemberAvatar&quot;: member.gravatar30(),
&quot;MemberKey&quot;: member.key(),
&quot;BookTitle&quot;: book.Title,
&quot;BookKey&quot;: book.key(),
&quot;CoverImage&quot;: book.getCover().thumbURL45(),
&quot;MessageTitle&quot;: message.Topic,
&quot;MessageBody&quot;: message.Text
}</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1580)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">template = Template(self.BodyTemplate)
return template.safe_substitute(data)</p>
</dd>
<dt>def getTargets(self, params): #Get the list of member who will receive the story posts</dt>
<dd>targets = []
targets.append(params[&quot;book&quot;].Author)
targets.append(params[&quot;member&quot;])
return targets</dd>
</dl>
</blockquote>
<p># This story warns all admins that the site cache has been flushed
class StorySiteCacheIsFlushed(stories.Story):</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1591)</p>
Unexpected indentation.</div>
<blockquote>
<p>ID = &quot;SiteCacheIsFlushed&quot;
TitleTemplate = _('&lt;a href=&quot;/Members/$MemberKey&quot;&gt;$MemberFullname&lt;/a&gt; has flushed the site cache')
BodyTemplate = &quot;&quot;
Icon = &quot;flush.png&quot;</p>
<dl class="docutils">
<dt>def getTitle(self, params):</dt>
<dd><p class="first">member = params[&quot;member&quot;]
data = {</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1599)</p>
Unexpected indentation.</div>
<blockquote>
&quot;MemberFullname&quot;: member.fullname(),
&quot;MemberKey&quot;: member.key()
}</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1602)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">template = Template(self.TitleTemplate)
return template.safe_substitute(data)</p>
</dd>
<dt>def getTargets(self, params): #Get the list of member who will receive the story posts</dt>
<dd>return membership.Member.all().filter(&quot;isAdmin =&quot;, True).fetch(limit=999)</dd>
</dl>
</blockquote>
<p>#============================================================================</p>
<dl class="docutils">
<dt>URLMappings = [</dt>
<dd>( '/', Home),
(r'/NewChapter/(.*)', NewChapter),
(r'/ViewChapter/(.*)', ViewChapter),
(r'/Chapter/Delete/(.*)', DeleteChapter),
(r'/EditChapter/(.*)', EditChapterOptions),
(r'/Typewriter/(.*)', Typewriter),
(r'/Feedback/Book/(.*)', FeedbackBook),
(r'/Feedback/Delete/(.*)', DeleteMessage),
( '/PostMessage', PostMessage),
(r'/Join/(.*)', Join), #Refactor: Should this be moved in the membership module?
( '/EditAccount', EditAccount), #Refactor: Should this be moved in part in the membership module?
( '/Account/View', AccountView),
( '/Account/ChangeProfilePhoto', AccountChangeProfilePhoto),
( '/Account/ChangePassword', AccountChangePassword),
( '/Books', Books),
( '/Books/', Books),
(r'/Books/Edit/License/(.*)', Books_Edit_License),
(r'/Books/Edit/(.*)', Books_Edit),
(r'/Books/SetCover/(.*)', BookSetCover),
(r'/Books/ReorderChapters/(.*)', Book_ReorderChapters),
(r'/Books/Delete/(.*)', DeleteBook),
(r'/Books/Chapters/(.*)/Rev/(.*)', Revisions_View),
(r'/Books/Chapters/(.*)/Rev', Revisions_List),
(r'/Books/(.*)', ViewBook),
( '/Members', Members),
(r'/Members/(.*)/Covers', MembersCoversList),
(r'/Members/(.*)/Books', MembersBooksList),
(r'/Members/(.*)/Readings', MembersReadingsList),
(r'/Members/(.*)/Profile', MembersProfile),
(r'/Members/(.*)', MembersFeed),
(r'/Readers/Book/(.*)', BookReaders),
( '/Covers/', CoverList),
(r'/Covers/Thumbnail/(.*)', CoverThumbnail),
(r'/Covers/Image/(.*)', CoverImage),
(r'/Covers/Edit/(.*)', CoverEdit),
(r'/Covers/Share/(.*)', CoverShare),
(r'/Covers/Unshare/(.*)', CoverUnshare),
( '/Covers/SetDefault', CoverSetDefault),
( '/Covers/Select', CoverSelect),
(r'/Covers/(.*)', CoverView),
( '/SetDefaultTheme', SetDefaultTheme),
( '/Admin/Commands', AdminCommands), # Refactor: move to an admin module?
( '/Login', Login), # Refactor: move to the membership module?
( '/Logout', Logout), # Refactor: move to the membership module?
( '/Customize', Customize),
(r'/PasswordSent/(.*)', PasswordSent),
(r'/ResetPassword/(.*)', ResetPassword),
(r'/SendPassword/(.*)', SendPassword),
( '/About/OpenSourceAttribution', About_OpenSoureAttribution),
( '/About/OpenSourceLicense', About_OpenSoureLicense),
( '/About/CPAL', About_CPAL),
( '/About/Who', About_who),
( '/Suggestions', Suggestions),
(r'/Admin/Commands/(.*)', AdminCommands), # Refactor: move to an admin module?
( '/FlushCache', FlushCache) # Refactor: move to an admin module?</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1669)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>]</p>
<p># Integrate the Labs module
URLMappings += stories.URLMappings()
stories.onRequest = onRequest</p>
<p># Integrate the Labs module
URLMappings += labs.URLMappings()
labs.onRequest = onRequest</p>
<p># Integrates the Customize module
URLMappings += customize.URLMappings()
customize.onRequest = onRequest</p>
<p># Integrates the Membership module
URLMappings += membership.URLMappings()
membership.onRequest = onRequest</p>
<p># Integrates the Membership module
URLMappings += proforma.URLMappings()
proforma.onRequest = onRequest</p>
<p># Integrate the Talk module
URLMappings += talk.URLMappings()
talk.onRequest = onRequest</p>
<p>application = WrookApplication(URLMappings, debug=True) # Instantiate the main application</p>
<p># Application constants
picnikKey = &quot;eb44efec693047ac4f4b2a429bc0be5a&quot; # Developper Key for the Picnik API</p>
<dl class="docutils">
<dt>class WrookAppConfig(db.Expando):</dt>
<dd>DefaultCover = db.ReferenceProperty(Cover, verbose_name=_(&quot;Default cover&quot;))
EncryptionKey = db.StringProperty(verbose_name=_(&quot;Encryption key&quot;)) # Used when a scecret key is needed for encrypting passwords and other data</dd>
<dt>def getWrookAppConfig():</dt>
<dd><p class="first">wrookAppConfig = memcache.get(&quot;wrookAppConfig&quot;)
if not wrookAppConfig:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1707)</p>
Unexpected indentation.</div>
<blockquote>
cfg = WrookAppConfig.all().fetch(limit=1)
if len(cfg) == 1: wrookAppConfig = cfg[0]
memcache.add(&quot;wrookAppConfig&quot;, wrookAppConfig)</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">C:\wrook\root\latest\wrook.py</tt>, line 1710)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p class="last">return wrookAppConfig</p>
</dd>
<dt>def real_main():</dt>
<dd>sys.path.append(os.path.dirname(__file__))
sys.path.append(os.path.join(os.path.dirname(__file__), 'feathers'))
logging.getLogger().setLevel(logging.DEBUG)
webapp.run(application)</dd>
<dt>def profile_log_main():</dt>
<dd># This is the main function for profiling
# We've renamed our original main() above to real_main()
import cProfile, pstats, StringIO
prof = cProfile.Profile()
prof = prof.runctx(&quot;real_main()&quot;, globals(), locals())
stream = StringIO.StringIO()
stats = pstats.Stats(prof, stream=stream)
stats.sort_stats(&quot;time&quot;)  # Or cumulative
stats.print_stats(80)  # 80 = how many to print
# The rest is optional.
# stats.print_callees()
# stats.print_callers()
logging.info(&quot;Profile <a class="reference external" href="data:n%s">data:n%s</a>&quot;, stream.getvalue())</dd>
<dt>def profile_html_main():</dt>
<dd># This is the main function for profiling
# We've renamed our original main() above to real_main()
import cProfile, pstats
prof = cProfile.Profile()
prof = prof.runctx(&quot;real_main()&quot;, globals(), locals())
print &quot;&lt;div style='text-align:left;font-size:1.1em; color: #000; background: #fff; padding: 20px;'&gt;&lt;pre&gt;&quot;
stats = pstats.Stats(prof)
#stats.sort_stats(&quot;time&quot;)  # Or cumulative
stats.sort_stats(&quot;cumulative&quot;)  # Or cumulative
stats.print_stats(300)  # 80 = how many to print
# The rest is optional.
# stats.print_callees()
# stats.print_callers()
print &quot;&lt;/pre&gt;&lt;/div&gt;&quot;</dd>
</dl>
<p>main = real_main</p>
<dl class="docutils">
<dt>if __name__ == '__main__':</dt>
<dd>main()</dd>
</dl>
</div>
</body>
</html>
